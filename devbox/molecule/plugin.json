{
  "name": "molecule",
  "packages": [
    "python@3.12",
    "uv@latest",
    "gnumake@latest",
    "yq@latest",
    "git@latest",
    "expect@latest",
    "libisoburn@latest",
    "gnupg@latest",
    "xfsprogs@latest"
  ],
  "env": {
    "VIRTENV": "{{.Virtenv}}",
    "PYPROJECT": "{{.Virtenv}}",
    "MAKEFILE": "{{.Virtenv}}/Makefile"
  },
  "create_files": {
    "{{.Virtenv}}/Makefile": "config/Makefile",
    "{{.Virtenv}}/pyproject.toml": "config/pyproject.toml",
    "{{.Virtenv}}/.yamllint": "config/.yamllint",
    "{{.Virtenv}}/action_all_lint.yml": "config/lint.yml",
    "{{.Virtenv}}/action_all_release.yml": "config/release.yml",
    "{{.Virtenv}}/action_collection_build.yml": "config/build.yml",
    "{{.Virtenv}}/action_collection_version.yml": "config/version.yml",
    "{{.Virtenv}}/action_role_molecule.yml": "config/molecule.yml"
  },
  "shell": {
    "init_hook": [
      ". .venv/bin/activate",
      "echo Run 'make (init|overwrite)' to initialize or update the testing environment",
      "alias make='\\make $( ([ -f Makefile ] || echo \"-f {{.Virtenv}}/Makefile\") )'",
      "alias uv='\\uv $( ([ -f pyproject.toml ] || echo \"--directory {{.Virtenv}}\") )'",
      "export LD_LIBRARY_PATH=${DEVBOX_PACKAGES_DIR}/lib:$LD_LIBRARY_PATH"
    ],
    "scripts": {
      "init": "\\make -f ${MAKEFILE} init"
    }
  }
}
